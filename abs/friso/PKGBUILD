pkgname=friso
pkgver=1.6.3
pkgrel=1
pkgdesc="An opensource tokenizer for Chinese."
arch=('i686' 'x86_64' 'armv7h')
url="https://github.com/lionsoul2014/friso/"
license=('Apache License 2.0')
source=("https://github.com/lionsoul2014/$pkgname/archive/v$pkgver-release.tar.gz")
makedepends=('gcc')

build() {
    cd $srcdir/$pkgname-$pkgver-release/src
    sed -i -e "s/\.\/vendors\//\/usr\/share\//g" $srcdir/$pkgname-$pkgver-release/friso.ini

    LD_LIBRARY_PATH=$srcdir/$pkgname-$pkgver-release/src:$LD_LIBRARY_PATH
    make
}

prepare_dir() {
    mkdir -p $pkgdir/usr/include/friso
    mkdir -p $pkgdir/usr/lib
    mkdir -p $pkgdir/usr/bin
    mkdir -p $pkgdir/etc/friso
    mkdir -p $pkgdir/usr/share/friso
}

install_package() {
    install -m 644 $srcdir/$pkgname-$pkgver/src/friso.h $pkgdir/usr/include/friso
    install -m 644 $srcdir/$pkgname-$pkgver/src/friso_API.h $pkgdir/usr/include/friso
    install -m 744 $srcdir/$pkgname-$pkgver/src/friso  $pkgdir/usr/bin
    install -m 644 $srcdir/$pkgname-$pkgver/src/libfriso.so  $pkgdir/usr/lib
    install -m 644 $srcdir/$pkgname-$pkgver/friso.ini  $pkgdir/etc/friso
    cp -R $srcdir/$pkgname-$pkgver/dict  $pkgdir/usr/share/friso
}

package() {
    cd $srcdir/$pkgname-$pkgver
    prepare_dir

    install_package
}
sha1sums=('f8f96ad1d09dadda52cb7b43e27630dd8d99fff1')
